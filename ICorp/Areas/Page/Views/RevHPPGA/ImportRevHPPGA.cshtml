@using Microsoft.AspNetCore.Http;

@{
    ViewData["Title"] = "Revenue HPP GA Import";
}

@section Styles {
    <link rel="stylesheet" href="~/lib/datatables-bs5/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="~/lib/datatables-responsive-bs5/responsive.bootstrap5.min.css">
    <link href="https://cdn.datatables.net/rowgroup/1.2.0/css/rowGroup.dataTables.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/bs-stepper.css">
    <style>
        .select2-container {
            width: 100% !important;
        }

        .select2-dropdown {
          z-index: 1090 !important;
        }

        

        table.dataTable tr.dtrg-group.dtrg-level-0 td {
            font-weight: bold;
        }
        table.dataTable tr.dtrg-group td {
            background-color: #e0e0e0;
        }
        table.dataTable tr.dtrg-group.dtrg-level-1 td:first-child{
            padding-left: 2.5rem !important;
        }
        table.dataTable tr.dtrg-group.dtrg-level-1 td{
            background-color: #f0f0f0;
            padding-top: 0.25rem !important;
            padding-bottom: 0.25rem !important;
        }
        table.dataTable tr.dtrg-group.dtrg-level-2 td:first-child {
            padding-left: 3.5rem !important;
        }
        table.dataTable tr.dtrg-group.dtrg-level-2 td {
            background-color: #fff0f0;
        }
        table.dataTable.compact tbody tr td.order_id {
            padding-left: 4.5rem !important;
        }

        .bs-stepper.vertical .bs-stepper-header {
            width: 18rem !important;
        }

        .bs-stepper.vertical .bs-stepper-content {
            /*width: 100%*/
            width: calc(100% - 18rem) !important;
        }

    </style>
}
<script type="text/javascript">
        //localStorage.clear();
        //var
        //    localDataHeader = JSON.parse(localStorage.getItem("header-parameters")),
        //    localDataContent = JSON.parse(localStorage.getItem("content-parameters")),
        //    localDataFUK = JSON.parse(localStorage.getItem("fuk-details")),
        //    localDataUP = JSON.parse(localStorage.getItem("up-links")),
        //    storedHeaderParameter = !localDataHeader ? new Array : localDataHeader,
        //    storedContentParameter = !localDataContent ? new Array : localDataContent,
        //    storedFUKDetail = !localDataFUK ? new Array : localDataFUK,
        //    storedUPLink = !localDataUP ? new Array : localDataUP;

        var
            localDataHeader = new Array,
            localDataContent = new Array,
            localDataFUK = new Array,
            localDataUP = new Array,
            storedHeaderParameter = new Array,
            storedContentParameter = new Array,
            storedFUKDetail = new Array,
            storedUPLink = new Array;

    </script>

<div id="loadingContent" class="container-xxl flex-grow-1 container-p-y d-none">
    <div class="card">
        <div class="card-body text-center">
            <div class="spinner-grow text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div class="spinner-grow text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>
</div>

<div id="contentPage" class="container-xxl flex-grow-1 container-p-y">
    <h4 class="fw-bold py-3 mb-4"><span class="text-muted fw-light">Page /</span> <span class="text-muted fw-light">Revenue HPP GA /</span> Import</h4>
    <div class="card">
        <div class="card-header d-flex border-bottom">
            <div class="row">
                <div class="col-12">
                    <ul class="nav nav-pills nav- card-header-pills" role="tablist">
                        <li class="nav-item">
                            <button type="button" class="nav-link active" role="tab" data-bs-toggle="tab" data-bs-target="#navs-pills-excel-file" aria-controls="navs-pills-excel-file" aria-selected="true">Excel File</button>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="tab-content">
            <div class="tab-pane fade active show" id="navs-pills-excel-file" role="tabpanel">
                <div class="row">
                    <label for="templateFile" class="col-md-2 col-form-label"></label>
                    <div class="col-md-10">
                        <a href="~/template/TemplateInputRJPPRevGA.xlsx">Download Template </a>
                    </div>
                </div> 
                <div class="row">
                    <label for="formFile" class="col-md-2 col-form-label">Import File</label>
                    <div class="col-md-10">
                        <input class="form-control" type="file" id="formFile">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <button id="btnUploadFile" class="btn btn-primary">Upload</button>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header border-bottom bg-info py-3">
                                <h5 class="card-title m-0 me-2 text-white">Preview data from excel (Detail Revenue HPP GA)</h5>
                            </div>
                        </div>
                         <div class="card-datatable table-responsive text-nowrap">
                            <table id="dataTableDetail" class="table no-footer">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>SegmentRJPP</th>
                                        <th>NamaCostCenter</th>
                                        <th>HP</th>
                                        <th>UniqueCode</th>
                                        <th>PIC</th>
                                        <th>Costumer</th>
                                        <th>Project</th>
                                        <th>HPPSales</th>
                                        <th>GASales</th>
                                        @* <th>Ownership</th>
                                        <th>Probability</th> *@
                                        @* <th>Tahun</th> *@
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header border-bottom bg-info py-3">
                                <h5 class="card-title m-0 me-2 text-white">Preview data from excel (Revenue)</h5>
                            </div>
                        </div>
                         <div class="card-datatable table-responsive text-nowrap">
                            <table id="dataTableRevenue" class="table no-footer">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Tahun</th>
                                        <th>Revenue</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header border-bottom bg-info py-3">
                                <h5 class="card-title m-0 me-2 text-white">Preview data from excel (HPP)</h5>
                            </div>
                        </div>
                        <div class="card-datatable table-responsive text-nowrap">
                            <table id="dataTableHPP" class="table no-footer">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Tahun</th>
                                        <th>HPP</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <button id="btnSubmit" class="btn btn-success">Submit</button>
                    </div>
                    <div class="col-md-12">
                        <button id="btnEdit" class="btn btn-success">Submit</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="partialScript"></div>

@section Scripts {
    <script src="~/assets/vendor/datatables/jquery.dataTables.min.js"></script>
    <script src="~/lib/datatables-bs5/dataTables.bootstrap5.min.js"></script>
    <script src="~/lib/datatables-responsive-bs5/responsive.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/rowgroup/1.2.0/js/dataTables.rowGroup.min.js"></script>
    <script src="~/assets/vendor/libs/bsStepper/bs-stepper.min.js"></script>

    <!-- Page level custom scripts -->
    @*<script src="~/js/demo/dataTable-demos.js"></script>*@
    <script src="~/js/pages/RevHPPGA/import-rev-hppga.js"></script>
}